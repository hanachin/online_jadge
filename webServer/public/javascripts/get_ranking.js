// Generated by CoffeeScript 1.4.0
var TABLE_TMP, get_ranking;

TABLE_TMP = '<table class="table table-bordered" style="padding: 20px; width: 1030px; margin: auto; margin-top: 15px;">\n  <tbody id="list">\n    <tr style="background-color: #E8E8E8;">\n      <td>ユーザ名</td>\n      <td>問題名</td>\n      <td>解答状況</td>\n      <td>提出時間</td>\n    </tr>\n  </tbody>\n</table>';

$(function() {
  return get_ranking();
});

get_ranking = function() {
  var timerID;
  $.ajax({
    url: "/get_ranking",
    type: "get",
    dataType: 'text'
  }).done(function(data) {
    var date, fullyear, obj, resJSON, table_calum, time, _i, _len;
    console.log(data);
    resJSON = $.parseJSON(data);
    $('#status').html(TABLE_TMP);
    table_calum = "";
    for (_i = 0, _len = resJSON.length; _i < _len; _i++) {
      obj = resJSON[_i];
      date = obj.time.split('T');
      time = date[1].split('.000Z')[0];
      fullyear = date[0];
      table_calum += "<tr>\n  <td>" + obj.userID + "</td>\n  <td>" + obj.questionNo + "</td>\n  <td>" + obj.result + "</td>\n  <td><time>" + fullyear + " " + time + "</time></td>\n</tr>";
    }
    return $('#list').append(table_calum);
  }).fail(function() {
    return alert('サーバ通信エラー');
  });
  return timerID = setTimeout(get_ranking, 3000);
};
